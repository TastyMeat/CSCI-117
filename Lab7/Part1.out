[local ["Generate","Zip","X","Y","Z","Times","Merge","GenerateHamming","Take","HammingSequence"] [Generate = proc {$ N EXU1} [EXU1 = proc {$ EXU2} [local ["EXU3","EXU4"] [EXU3 = N,local ["EXU5"] [local ["EXU6","EXU7"] [EXU6 = N,EXU7 = 1,"IntPlus" "EXU6" "EXU7" "EXU5"],"Generate" "EXU5" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]],Zip = proc {$ X Y EXU1} [EXU1 = proc {$ EXU2} [local ["V","F","PTU2"] [PTU2 = '#'(1:V 2:F),"X" "PTU2",local ["EXU3","EXU4"] [EXU3 = V,local ["EXU5","EXU6"] [EXU5 = Y,EXU6 = F,"Zip" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],local ["EXU1"] [EXU1 = 3,"Generate" "EXU1" "X"],local ["EXU1"] [EXU1 = 5,"Generate" "EXU1" "Y"],local ["EXU1","EXU2"] [EXU1 = X,EXU2 = Y,"Zip" "EXU1" "EXU2" "Z"],local ["V1","F1","PTU0"] [PTU0 = '#'(1:V1 2:F1),"Z" "PTU0",local ["V2","F2","PTU0"] [PTU0 = '#'(1:V2 2:F2),"F1" "PTU0",local ["V3","F3","PTU0"] [PTU0 = '#'(1:V3 2:F3),"F2" "PTU0",skip/BV1,skip/BV2,skip/BV3]]],Times = proc {$ N Hs EXU1} [EXU1 = proc {$ EXU2} [local ["H","Hr","PTU2"] [PTU2 = '#'(1:H 2:Hr),"Hs" "PTU2",local ["EXU3","EXU4"] [local ["EXU5","EXU6"] [EXU5 = N,EXU6 = H,"IntMultiply" "EXU5" "EXU6" "EXU3"],local ["EXU5","EXU6"] [EXU5 = N,EXU6 = Hr,"Times" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]]],Merge = proc {$ Xs Ys EXU1} [EXU1 = proc {$ EXU2} [local ["X","Xr","PTU2"] [PTU2 = '#'(1:X 2:Xr),"Xs" "PTU2",local ["Y","Yr","PTU2"] [PTU2 = '#'(1:Y 2:Yr),"Ys" "PTU2",local ["EXU3"] [local ["EXU4","EXU5"] [EXU4 = X,EXU5 = Y,"LT" "EXU4" "EXU5" "EXU3"],if EXU3 then [local ["EXU4","EXU5"] [EXU4 = X,local ["EXU6","EXU7"] [EXU6 = Xr,EXU7 = Ys,"Merge" "EXU6" "EXU7" "EXU5"],EXU2 = '#'(1:EXU4 2:EXU5)]] else [local ["EXU4"] [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = Y,"GT" "EXU5" "EXU6" "EXU4"],if EXU4 then [local ["EXU5","EXU6"] [EXU5 = Y,local ["EXU7","EXU8"] [EXU7 = Xs,EXU8 = Yr,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]] else [local ["EXU5","EXU6"] [EXU5 = X,local ["EXU7","EXU8"] [EXU7 = Xr,EXU8 = Yr,"Merge" "EXU7" "EXU8" "EXU6"],EXU2 = '#'(1:EXU5 2:EXU6)]]]]]]]]],GenerateHamming = proc {$ Hs EXU1} [EXU1 = proc {$ EXU2} [local ["EXU3","EXU4"] [EXU3 = 1,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = 2,EXU8 = Hs,"Times" "EXU7" "EXU8" "EXU5"],local ["EXU7","EXU8"] [local ["EXU9","EXU10"] [EXU9 = 3,EXU10 = Hs,"Times" "EXU9" "EXU10" "EXU7"],local ["EXU9","EXU10"] [EXU9 = 5,EXU10 = Hs,"Times" "EXU9" "EXU10" "EXU8"],"Merge" "EXU7" "EXU8" "EXU6"],"Merge" "EXU5" "EXU6" "EXU4"],EXU2 = '#'(1:EXU3 2:EXU4)]]],Take = proc {$ N Xs EXU1} [local ["EXU2"] [local ["EXU3","EXU4"] [EXU3 = N,EXU4 = 0,"GT" "EXU3" "EXU4" "EXU2"],if EXU2 then [local ["X","Xr","PTU2"] [PTU2 = '#'(1:X 2:Xr),"Xs" "PTU2",local ["EXU3","EXU4"] [EXU3 = X,local ["EXU5","EXU6"] [local ["EXU7","EXU8"] [EXU7 = N,EXU8 = 1,"IntMinus" "EXU7" "EXU8" "EXU5"],EXU6 = Xr,"Take" "EXU5" "EXU6" "EXU4"],EXU1 = '|'(1:EXU3 2:EXU4)]]] else [EXU1 = nil()]]],local ["EXU1","EXU2"] [EXU1 = 10,local ["EXU3"] [local ["EXU4"] [EXU4 = 1,"Generate" "EXU4" "EXU3"],"GenerateHamming" "EXU3" "EXU2"],"Take" "EXU1" "EXU2" "HammingSequence"],skip/BHammingSequence]]