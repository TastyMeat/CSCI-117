[local ["Producer","OddFilter","Consumer"] [Producer = proc {$ N Limit Out} [local ["EXU1"] [local ["EXU2","EXU3"] [EXU2 = N,local ["EXU5","EXU6"] [EXU5 = Limit,EXU6 = 1,"IntPlus" "EXU5" "EXU6" "EXU3"],"LT" "EXU2" "EXU3" "EXU1"],if EXU1 then [local ["T","N1"] [local ["EXU1","EXU2"] [EXU1 = N,EXU2 = T,Out = '|'(1:EXU1 2:EXU2)],local ["EXU1","EXU2"] [EXU1 = N,EXU2 = 1,"IntPlus" "EXU1" "EXU2" "N1"],local ["EXU1","EXU2","EXU3"] [EXU1 = N1,EXU2 = Limit,EXU3 = T,"Producer" "EXU1" "EXU2" "EXU3"]]] else [Out = nil()]]],OddFilter = proc {$ P Out} [case P of nil() then [Out = nil()] else [case P of '|'(1:X 2:Xs) then [local ["Filtered"] [local ["EXU1","EXU2"] [EXU1 = Xs,EXU2 = Filtered,"OddFilter" "EXU1" "EXU2"],local ["EXU1"] [local ["EXU2","EXU3"] [local ["EXU5","EXU6"] [EXU5 = X,EXU6 = 2,"Mod" "EXU5" "EXU6" "EXU2"],EXU3 = 0,"Eq" "EXU2" "EXU3" "EXU1"],if EXU1 then [local ["EXU1","EXU2"] [EXU1 = X,EXU2 = Filtered,Out = '|'(1:EXU1 2:EXU2)]] else [Out = Filtered]]]] else [skip]]],Consumer = proc {$ P EXU1} [case P of nil() then [EXU1 = 0] else [case P of '|'(1:X 2:Xs) then [local ["EXU2","EXU3"] [EXU2 = X,local ["EXU5"] [EXU5 = Xs,"Consumer" "EXU5" "EXU3"],"IntPlus" "EXU2" "EXU3" "EXU1"]] else [skip]]],local ["N","L","P","F","C"] [N = 0,L = 100,thread [local ["EXU1","EXU2","EXU3"] [EXU1 = N,EXU2 = L,EXU3 = P,"Producer" "EXU1" "EXU2" "EXU3"],skip/BP],thread [local ["EXU1","EXU2"] [EXU1 = P,EXU2 = F,"OddFilter" "EXU1" "EXU2"],skip/BF],thread [local ["EXU1"] [EXU1 = F,"Consumer" "EXU1" "C"],skip/BC]]]]